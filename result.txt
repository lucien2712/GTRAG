(timerag) C:\GTRAG\examples>python demo_gemini.py
============================================================
gtrag API Usage Demo
============================================================
1. üöÄ Initializing gtrag System...
2025-09-03 13:14:21,057 - INFO - Initialized FAISS vector store: dimension=768, metric=cosine, type=flat
2025-09-03 13:14:21,057 - INFO - Initialized FAISS vector store
2025-09-03 13:14:21,315 - INFO - gtrag system initialized successfully.
   ‚úÖ System initialization completed successfully

2. üìÑ Indexing documents with temporal metadata...
2025-09-03 13:14:21,315 - INFO - Starting document insertion: apple_q4_2023
2025-09-03 13:14:21,315 - INFO - Standardized time for apple_q4_2023: 2023Q4 (quarter)
2025-09-03 13:14:21,315 - INFO - Document apple_q4_2023 split into 1 chunks.
2025-09-03 13:14:24,140 - INFO - LLM response for apple_q4_2023 (first 500 chars): {"entities": [{"entity_name": "Apple Inc.", "entity_type": "COMPANY", "entity_description": "The company that produces iPhones"}, {"entity_name": "iPhone", "entity_type": "PRODUCT", "entity_description": "A smartphone produced by Apple Inc."}, {"entity_name": "80 million units", "entity_type": "FINANCIAL_METRIC", "entity_description": "The number of iPhones sold in Q4 2023"}, {"entity_name": "Q4 2023", "entity_type": "FINANCIAL_METRIC", "entity_description": "The fourth quarter of the year 2023"
2025-09-03 13:14:24,140 - INFO - Received JSON response from LLM with 4 entities, 4 relations
2025-09-03 13:14:24,140 - INFO - Successfully parsed JSON format: 4 entities, 4 relations
2025-09-03 13:14:24,146 - INFO - Chunk apple_q4_2023_chunk_0 extracted 4 entities, 4 relations.
   ‚ùå Failed to index apple_q4_2023: 'list' object has no attribute 'reshape'
2025-09-03 13:14:24,546 - INFO - Starting document insertion: apple_launch_sep_2023
2025-09-03 13:14:24,546 - INFO - Standardized time for apple_launch_sep_2023: 2023-09-15 (day)
2025-09-03 13:14:24,546 - INFO - Document apple_launch_sep_2023 split into 1 chunks.
2025-09-03 13:14:28,023 - INFO - LLM response for apple_launch_sep_2023 (first 500 chars): {"entities": [{"entity_name": "Apple", "entity_type": "COMPANY", "entity_description": "A technology company that launched the iPhone 15."}, {"entity_name": "iPhone 15", "entity_type": "PRODUCT", "entity_description": "A new iPhone model launched by Apple on September 15, 2023.  It features a titanium design and enhanced camera capabilities."}, {"entity_name": "September 15, 2023", "entity_type": "Other", "entity_description": "The launch date of the iPhone 15."}, {"entity_name": "titanium desig
2025-09-03 13:14:28,023 - INFO - Received JSON response from LLM with 5 entities, 4 relations
2025-09-03 13:14:28,023 - INFO - Successfully parsed JSON format: 5 entities, 4 relations
2025-09-03 13:14:28,023 - INFO - Chunk apple_launch_sep_2023_chunk_0 extracted 5 entities, 4 relations.
   ‚ùå Failed to index apple_launch_sep_2023: 'list' object has no attribute 'reshape'
2025-09-03 13:14:28,385 - INFO - Starting document insertion: ms_march_2024
2025-09-03 13:14:28,385 - INFO - Standardized time for ms_march_2024: 2024-03 (month)
2025-09-03 13:14:28,385 - INFO - Document ms_march_2024 split into 1 chunks.
2025-09-03 13:14:31,459 - INFO - LLM response for ms_march_2024 (first 500 chars): {"entities": [{"entity_name": "Microsoft", "entity_type": "COMPANY", "entity_description": "A technology company whose cloud business revenue grew significantly in March 2024."}, {"entity_name": "30%", "entity_type": "FINANCIAL_METRIC", "entity_description": "The percentage growth of Microsoft's cloud business revenue in March 2024."}, {"entity_name": "March 2024", "entity_type": "Other", "entity_description": "The month and year in which Microsoft's cloud business revenue grew significantly."},
2025-09-03 13:14:31,459 - INFO - Received JSON response from LLM with 4 entities, 3 relations
2025-09-03 13:14:31,459 - INFO - Successfully parsed JSON format: 4 entities, 3 relations
2025-09-03 13:14:31,459 - INFO - Chunk ms_march_2024_chunk_0 extracted 4 entities, 3 relations.
   ‚ùå Failed to index ms_march_2024: 'list' object has no attribute 'reshape'
2025-09-03 13:14:31,849 - INFO - Starting document insertion: google_annual_2024
2025-09-03 13:14:31,849 - INFO - Standardized time for google_annual_2024: 2024 (year)
2025-09-03 13:14:31,849 - INFO - Document google_annual_2024 split into 1 chunks.
2025-09-03 13:14:34,643 - INFO - LLM response for google_annual_2024 (first 500 chars): {"entities": [{"entity_name": "Google", "entity_type": "COMPANY", "entity_description": "A technology company that held a developer conference in 2024"}, {"entity_name": "2024", "entity_type": "Other", "entity_description": "The year Google's developer conference was held"}, {"entity_name": "AI advances", "entity_type": "TECHNOLOGY", "entity_description": "Major advancements in artificial intelligence showcased at the conference"}, {"entity_name": "cloud computing capabilities", "entity_type": "
2025-09-03 13:14:34,643 - INFO - Received JSON response from LLM with 4 entities, 3 relations
2025-09-03 13:14:34,643 - INFO - Successfully parsed JSON format: 4 entities, 3 relations
2025-09-03 13:14:34,643 - INFO - Chunk google_annual_2024_chunk_0 extracted 4 entities, 3 relations.
   ‚ùå Failed to index google_annual_2024: 'list' object has no attribute 'reshape'
2025-09-03 13:14:34,993 - INFO - Starting document insertion: spacex_phase_alpha
2025-09-03 13:14:34,993 - INFO - Standardized time for spacex_phase_alpha: Phase-Alpha (custom)
2025-09-03 13:14:34,993 - INFO - Document spacex_phase_alpha split into 1 chunks.
2025-09-03 13:14:38,698 - INFO - LLM response for spacex_phase_alpha (first 500 chars): {"entities": [{"entity_name": "SpaceX", "entity_type": "COMPANY", "entity_description": "A company that successfully tested the new Raptor engine design for improved efficiency during Phase-Alpha of the Mars mission project."}, {"entity_name": "Raptor engine", "entity_type": "PRODUCT", "entity_description": "New engine design tested by SpaceX for improved efficiency."}, {"entity_name": "Mars mission project", "entity_type": "BUSINESS_CONCEPT", "entity_description": "The project during which Spac
2025-09-03 13:14:38,698 - INFO - Received JSON response from LLM with 4 entities, 5 relations
2025-09-03 13:14:38,698 - INFO - Successfully parsed JSON format: 4 entities, 5 relations
2025-09-03 13:14:38,698 - INFO - Chunk spacex_phase_alpha_chunk_0 extracted 4 entities, 5 relations.
   ‚ùå Failed to index spacex_phase_alpha: 'list' object has no attribute 'reshape'

3. üîó Building temporal connections...
2025-09-03 13:14:39,064 - INFO - Building temporal connections...
2025-09-03 13:14:39,074 - INFO - Building temporal connections using flexible TimeHandler...
2025-09-03 13:14:39,074 - INFO - Added 0 temporal evolution connections
2025-09-03 13:14:39,074 - INFO - Temporal connections built successfully.
   ‚úÖ Temporal connections built successfully

üìä System Statistics:
   - Documents indexed: 0
   - Graph nodes: 5
   - Graph edges: 0
   - Stored chunks: 5

4. üîç Query 1: What are the trends in Apple iPhone sales and product launches?
--------------------------------------------------------------------------------
2025-09-03 13:14:39,074 - INFO - Processing query: What are the trends in Apple iPhone sales and product launches?
2025-09-03 13:14:40,253 - INFO - Keywords extracted: high_level=2, low_level=2
2025-09-03 13:14:41,438 - INFO - Retrieved 0 entities, 0 relations.
2025-09-03 13:14:41,438 - INFO - Found 0 primary + 0 supplementary = 0 total unique chunks.
2025-09-03 13:14:41,438 - INFO - Final context prepared, total tokens: 80
2025-09-03 13:14:42,644 - INFO - Answer generation completed.
üìù Answer:
{"Key Findings": "I do not have access to real-time sales data or internal Apple information to provide specific trends in iPhone sales and product launches.  Information on this topic changes rapidly.", "Supporting Evidence": "My knowledge about Apple iPhone sales and product launches is limited to publicly available information before November 2023.  To get the most up-to-date trends, you should consult recent financial reports from Apple, reputable technology news sources, and market analysis firms.", "References": []}

üìà Retrieved Context:
   - Entities: 0
   - Relations: 0
   - Source chunks: 0
   - Total tokens: 80
   - Entity tokens: 0
   - Relation tokens: 0
   - Chunk tokens: 0

============================================================
üíæ Demonstrating Persistence & Reloading
============================================================

8. üíæ Saving gtrag system to working directory './demo_gtrag_workspace/'...
C:\Users\ericy\.conda\envs\timerag\lib\site-packages\networkx\readwrite\json_graph\node_link.py:142: FutureWarning:
The default value will be `edges="edges" in NetworkX 3.6.

To make this warning go away, explicitly set the edges kwarg, e.g.:

  nx.node_link_data(G, edges="links") to preserve current behavior, or
  nx.node_link_data(G, edges="edges") for forward compatibility.
  warnings.warn(
2025-09-03 13:14:42,665 - INFO - Graph saved to demo_gtrag_workspace\graph.json
2025-09-03 13:14:42,665 - INFO - Knowledge graph saved to: demo_gtrag_workspace\graph.json
2025-09-03 13:14:42,665 - INFO - Chunk store saved to: demo_gtrag_workspace\chunks.json
2025-09-03 13:14:42,665 - INFO - Saved FAISS vector store to demo_gtrag_workspace\vectors
2025-09-03 13:14:42,665 - INFO - Vector store saved to: demo_gtrag_workspace\vectors.*
2025-09-03 13:14:42,665 - INFO - Complete gtrag system saved to working directory: ./demo_gtrag_workspace/
   ‚úÖ gtrag system saved successfully!
   üìÅ Working directory created: demo_gtrag_workspace
   üìÅ Files created:
      - graph.json (Knowledge graph with entities/relations)
      - chunks.json (Original text chunks for context)
      - vectors.faiss (Vector index for fast search)
      - vectors.metadata.npy (Vector metadata)
   üìã Directory contents (4 files):
      - chunks.json (0.7 KB)
      - graph.json (86.3 KB)
      - vectors.faiss (0.0 KB)
      - vectors.metadata.npy (0.4 KB)

9. üìÇ Loading gtrag system from working directory...
2025-09-03 13:14:43,047 - INFO - Initialized FAISS vector store: dimension=768, metric=cosine, type=flat
2025-09-03 13:14:43,047 - INFO - Initialized FAISS vector store
2025-09-03 13:14:43,048 - INFO - gtrag system initialized successfully.
C:\Users\ericy\.conda\envs\timerag\lib\site-packages\networkx\readwrite\json_graph\node_link.py:287: FutureWarning:
The default value will be changed to `edges="edges" in NetworkX 3.6.

To make this warning go away, explicitly set the edges kwarg, e.g.:

  nx.node_link_graph(data, edges="links") to preserve current behavior, or
  nx.node_link_graph(data, edges="edges") for forward compatibility.
  warnings.warn(
2025-09-03 13:14:43,058 - INFO - Graph loaded from demo_gtrag_workspace\graph.json
2025-09-03 13:14:43,058 - INFO - Knowledge graph loaded from: demo_gtrag_workspace\graph.json
2025-09-03 13:14:43,058 - INFO - Chunk store loaded from: demo_gtrag_workspace\chunks.json
2025-09-03 13:14:43,058 - INFO - Loaded FAISS vector store from demo_gtrag_workspace\vectors
2025-09-03 13:14:43,058 - INFO - Vector store loaded from: demo_gtrag_workspace\vectors.*
2025-09-03 13:14:43,058 - INFO - Complete gtrag system loaded from working directory: ./demo_gtrag_workspace/
   ‚úÖ gtrag system loaded successfully!
   üìÇ Loaded from: demo_gtrag_workspace
   üìä Components loaded:
      - Graph: ‚úÖ
      - Chunks: ‚úÖ
      - Vectors: ‚úÖ
   üìä Loaded system statistics:
      - Documents: 0
      - Nodes: 5
      - Edges: 0
      - Chunks: 5

   üîç Testing query on loaded system...
2025-09-03 13:14:43,058 - INFO - Processing query: What did Apple achieve in 2024?
2025-09-03 13:14:44,088 - INFO - Keywords extracted: high_level=2, low_level=2
2025-09-03 13:14:45,231 - INFO - Retrieved 0 entities, 0 relations.
2025-09-03 13:14:45,231 - INFO - Found 0 primary + 0 supplementary = 0 total unique chunks.
2025-09-03 13:14:45,231 - INFO - Final context prepared, total tokens: 76
2025-09-03 13:14:46,053 - INFO - Answer generation completed.
      ‚úÖ Query successful! Answer length: 225
      üìä Retrieved: 0 entities, 0 relations

============================================================
üéâ Demo Completed Successfully!
============================================================

üí° You can now use the working directory:
   - To continue in another session: new_rag.load_graph('./demo_gtrag_workspace/')
   - All components are neatly organized in one directory
   - Easy to backup, share, or deploy to production
   - Clean separation of concerns with standardized file names

üìä Final System State:
   - indexed_documents: 0
   - indexed_chunks: 5
   - num_nodes: 5
   - num_edges: 0
   - node_types: {'entity': 5}
   - relation_keywords: {}
   - has_vector_store: True
   - total_vectors: 0
   - dimension: 768
   - metric: cosine
   - index_type: flat
   - is_trained: True
   - stored_chunks: 5

============================================================
Batch Processing Demo
============================================================
üìÅ Batch processing allows you to process multiple documents at once.
   Example usage:

    from gtrag.processing import BatchProcessor, BatchProcessingConfig

    # Configure batch processing
    config = BatchProcessingConfig(
        max_workers=4,
        batch_size=10,
        supported_formats=['.pdf', '.docx', '.txt', '.json']
    )

    # Initialize batch processor
    batch_processor = BatchProcessor(rag_system, config)

    # Process all documents in a directory
    results = batch_processor.process_directory("./documents/")

    # Process specific files
    file_list = ["doc1.pdf", "doc2.docx", "doc3.txt"]
    results = batch_processor.process_files(file_list)


   üìù This would process multiple files concurrently with:
      ‚Ä¢ Automatic file format detection
      ‚Ä¢ Flexible time extraction from filenames/content (quarters, dates, years, custom labels)
      ‚Ä¢ Progress tracking and error handling
      ‚Ä¢ Parallel processing for better performance